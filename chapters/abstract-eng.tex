\begin{englishabstract}

End-user programming has gained widespread attention, in which, spreadsheets are undoubtedly one of the most popular programming paradigms.
Spreadsheets are usually used to store, calculate, and analyze user data to help users perform data calculations and decision-making plans.
Since spreadsheets may contain a large amount of data and formula cells, and their structures and layouts vary from person to person, various types of defects may hidden in them.
Recently, hidden errors in spreadsheets have caused huge economic losses of many financial investment companies.

It is especially important to use automation technology to help end-users detect errors in spreadsheets.
Among them, how to automate the detection of spreadsheet defects related to formulas has received the most attention.
In the past two decades, researchers have proposed various methods to detect formula-related defects.
The current mainstream methods with better detection results can be divided into two categories based on their technical ideas: rule/pattern-based and clustering/learning-based defect detection technologies.
The former can usually detect specific types of cell defects with high accuracy based on pre-designed precise rules/patterns, but compared with the latter, the detection recall rate is not satisfactory;
The latter can cluster cells based on formula features and cell layout features, greatly improving the recall rate of detection, but compared with the former, its feature extraction is not accurate enough due to the complexity of spreadsheets, resulting in unsatisfactory precision performance.

Considering the above reasons, we proposes a novel technique WARDER based on \cu.
Although CUSTODES has the ability of adaptive learning across spreadsheets and various layout styles, meantime it has the disadvantage of absorbing related and unrelated cells into the same cluster.
Through the top-down validity checking of the cell class construction process, it can accurately filter out the cells that are not related to the cell cluster or the whole invalid cell cluster, effectively improving the effectiveness of cell clustering and defect detection.

In summary, the main contributions of this thesis are as follows:
\begin{enumerate}
    \item proposing \wa , a spreadsheet cell clustering and defect detection technology, focusing on the validity checking of the cell itself, the relationship between cells, and the entire cell cluster, improving the cell clustering effect of \cu , and improving the spreadsheet The effect of defect detection;
    
    \item using a spreadsheet benchmark widely used by related work and a large-scale spreadsheet corpus to fully evaluate \wa , compared with the current most popular other spreadsheet defect detection technologies;
    
    \item implementing two visualization tools: an Excel plug-in EGuard, while operating the Excel worksheet, end-users can see the detection results and execution information of the currently opened worksheet, so that they can quickly check and repair the tool report defects; another integrated visualization tool \sg, which can compare the detection results of a variety of mainstream technologies and display them in a unified manner.
\end{enumerate}

\englishkeywords{Spreadsheet Detection, Cell Clustering, Defect Detection, Validity Checking, Software Engineering}

\end{englishabstract}