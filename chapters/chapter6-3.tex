\section{实验结果和分析}
本节中，我们会依次分析实验结果并回答上述提出的三个研究问题。

\subsection{有效性}
我们首先实验评估 \wa 在单元格聚类和缺陷检测方面的有效性，然后和其它 5 个电子表格缺陷检测技术的结果进行比较。
\input{table/table2.tex}

就缺陷检测而言，表~\ref{table2}对比了所有 6 个检测技术的结果，包括精度，召回率，\fmd，检测出的缺陷数量，以及其中包含的真阳性和假阳性数量。
从表中，我们观察到：
\begin{enumerate}
    \item 由于它们有限的分析范围，\uc 和 \di 获得了较低的分数（精度和召回率都低于1\%，\fmd 值也仅有0.01），这点也与之前的实证研究结果~\cite{zhang2017effectively}保持一致；
    \item 由于它们使用精准的单元格阵列模式匹配规则来对单元格进行分组，\am 和 \ca 获得了较好的分数（56.1-72.3\%的精度，66.7-68.4\%的召回率，以及0.61-0.70的\fmd 值）；
    \item \cu 比 \ca 获得了略微更好的整体分数（0.71的 \fmd 值），其中对召回率有较大提升（72.8\%，对比 \ca 的召回率为68.4\%）；
    \item 与之前的预期相似，\wa 关注于提升检测精度，对比于 \cu 获得了大幅度提升，从64.7\% 提升到 87.8\%，最终整体上提升了 \fmd 的值，从 0.71 到 0.79，尽管对召回率有 6\% 的牺牲。
    从真阳性和假阳性数量上看，尽管 \cu 比 \wa 多检测出 124 个真阳性，但同时伴随着更多的假阳性（达 644 个），这大量的假阳性对于终端用户来说，进行耗时费力的手工验证是很大的负担。
\end{enumerate}

\input{figure/figure5.tex}
就单元格聚类而言，图\ref{figure5}比较了 \cu 和 \wa 在精度和召回率两方面的结果。
从精度比较来看，如图\ref{figure5}(a)，我们把包含至少有一个单元格类的 282 个工作表分成两类：
\begin{enumerate}
    \item \wa 提升了其中31个工作表的精度，降低了7个；
    \item 对于余下精度保持不变的244个工作表，其中194个已达到100\%（即上限）。
\end{enumerate}

换言之，\wa 提升了 225（31+194） 个工作表的单元格聚类精度，要么是实际提升了精度，要么精度已经达到上限。
如图\ref{figure6}所示，我们进一步观察这 38（31+7）个精度产生变化的工作表。
不难发现，\wa 在不同程度上提升了单元格聚类的精度（从 0.3\% 到 94.6\%，平均提升 20.7\%），这样的精度提升是显著的，远多于精度受损的部分。
另外从图\ref{figure5}(b)中，我们也注意到，\wa 在精度提升上的同时也仅导致召回率的轻微下降（2.4\%）。
\input{figure/figure6.tex}
\input{figure/figure7.tex}

如图~\ref{figure6}所示，我们也观察到，\wa 对大多数精度受影响的工作表是正面作用，但也有极少量的例外情况，如名为“Detail for College ...”的工作表，它的聚类精度从 100\% 降低到了0。
因此，我们进一步人工检查了该工作表的聚类情况。
如图\ref{figure7}所示，人工标记的结果是，\{O11，W11，Z11，AD11，AR11\} 应该被安排在同一个类中。
\cu 看似正确地对这些单元格进行了分类，而 \wa 分类得很差。
然而，我们发现这 5 个单元格实际上包含不同的公式，虽然都是求和运算，但单元格引用的范围各不相同，因此它们违反了 \wa 针对 \wcvp （在这些单元格中不存在一个公共的计算语义能够覆盖过半数量）。
事实上，这个单元格类的确不包含任何缺陷。
因此，这个单元格聚类精度下降的案例并不影响 \wa 的缺陷检测能力，实际上是最初的人工标注不合理。

因此，针对研究问题1，我们能够得出如下结论：\textit{\wa 在单元格聚类和缺陷检测方面是有效的。它极大地提升了精度，达 15.5-87.3\%，并且在所有被比较的电子表格缺陷检测技术中，取得了最佳的 \fmd 值（0.79）。}

\subsection{相关性}
\input{table/table3.tex}
在这一小节里，我们研究 \wa 相对于 \cu 在单元格聚类和缺陷检测上的的精度变化的相关性。

如表\ref{table3}所示，我们用三个符号 $\uparrow$、$\downarrow$ 和 $\to$ 分别表示精度提升、精度下降和精度保持不变这三种情况。
按照相关性类型，我们把人工标记中至少含有 1 个缺陷的工作表分成 3 个类型：
\begin{enumerate}
    \item \textit{正相关}：当相对于 \cu 的单元格聚类，\wa 的精度有提升、下降或不变时，在缺陷检测上精度变化表现一致；
    \item \textit{负相关}：当相对于 \cu 的单元格聚类，\wa 的精度提升时，在缺陷检测上精度下降或保持不变；或者相反地，\wa 的精度下降时，在缺陷检测上精度提升或保持不变；
    \item \textit{不相关}：其他的组合情况，均划归此类，既不表现出正相关，也不表现出负相关。
\end{enumerate}

总体而言，我们能够观察到：第一类占据主导（90.0\%），因此表明 \wa 对单元格聚类的精度提升方法的确能够带来缺陷检测精度的提升，并且九成比例的工作表成明显正相关。
\input{figure/figure8.tex}
\input{figure/figure9.tex}

图\ref{figure8}展示了在单元格聚类和缺陷检测上 \wa 和 \cu 的更细致的精度对比。
为了展示的清晰性和简洁性，我们移除了精度前后无变化的 116 个工作表，仅罗列出剩下的 24 个工作表。
细致观察可以发现：在单元格聚类和缺陷检测的精度变化上大部分情况下是正相关的。
不过，其中一个例外是名为“CO”的工作表，在这张表上，\wa 的缺陷检测精度从 100\% 跌至 0，然而单元格聚类精度却有提升。
我们进一步检查了这个情况。
如图\ref{figure9}所示，人工标注结果认为单元格\{B11，C11，E11，F11\}应该分别构成一个单元格类，并且单元格 C11 和 F11 应该是两个缺陷（用红色三角标记）。
\cu 因为意外地将这四个单元格分成同类，而偶然地检测到了这两个缺陷。
这是偶然的，因为这四个单元格本质上并不共享相同的计算语义（两个绿色的单元格用来计算最大值，而两个橙色的单元格用来计算次大值）。
\cu 将两个橙色的单元格标记为缺陷，因为他们仅仅包含纯数值（用数值替换的公式缺陷），暗示终端用户应当把 C11 和 F11 也改成对特定单元格引用区域的获取最大值公式。
另一方面，\wa 仅将 \{B11，E11\} 划分为同一类，而剔除了单元格 C11 和 F11，恰是因为识别出了两种不同的计算语义，因此无法检测到其中的任何缺陷。
\wa 没有把这两个橙色单元格吸纳进任何单元格类中，因为它们本身不包含公式，且工作表中没有和它们相同计算语义的公式存在，因而在目前的算法框架下，无法被吸纳到任何类中。
当没有额外的证据时（例如，更多的计算第二大值的单元格出现，并且相应的公式也存在于某些单元格中），\wa 选择不把这些单元格放到任何类中（否则，可能导致更多的假阳性），而 \cu 的检测结果恰好“歪打正着”。

因此，针对研究问题2，我们能够得出如下结论：\textit{\wa 在单元格聚类上的改进确实提升了缺陷检测的结果，这一相关性得到 90.0\% 的工作表的数据支撑。}

\subsection{独立性}
\input{table/table4.tex}
最后，我们研究 \wa 的三个有效性检验在检测电子表格缺陷上各自的表现。
\wa 被配置成单独使用每一种检验方法（正如前面提到的，命名为\wasc，\wamc 和\wawc ），并和同时使用三种方法的 \wa-full 作比较。

表\ref{table4}对比了 \cu 和 \wa 的四种配置的缺陷检测结果。
我们可以观察到：
\begin{enumerate}
    \item \wa 的每个有效性检验方法都是有效的，并且各自能够比 \cu 在缺陷检测精度上提升 4.9-7.6\%，在召回率上有较小的牺牲（1.9-2.3\%），最终对 \fmd 值有小幅提升，从 0.71 提升到 0.73-0.74；
    \item 组合所有三种有效性检验方法的 \wa-full 可以取得最高的精度（87.8\%）和 \fmd 值（0.79），这也和之前表\ref{table1}的数据相吻合。
\end{enumerate}

因此，针对研究问题3，我们能够得出如下结论：\textit{\wa 的三个基于有效性属性的检验方法能够各自独立表现出对缺陷检测的正面效果；同时在三者结合运用时，能够获得整体上的最佳效果。}